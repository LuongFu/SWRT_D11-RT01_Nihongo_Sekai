@using JapaneseLearningPlatform.Models.Partner
@using JapaneseLearningPlatform.Data.Enums
@model IEnumerable<PartnerProfile>

@{
    ViewData["Title"] = "Partner Applications";
    // Pull the current filter out of ViewData (set in your controller)
    var current = (PartnerStatus)(ViewData["CurrentFilter"] ?? PartnerStatus.Pending);
}

<h1 class="mb-4">@ViewData["Title"]</h1>

<!-- 1) Filter Tabs -->
<div class="btn-group mb-4" role="group">
    <a asp-action="PartnerApplications" asp-route-filter="Pending"
       class="btn @(current == PartnerStatus.Pending
                             ? "btn-primary"
                             : "btn-outline-primary")">
        Pending
    </a>
    <a asp-action="PartnerApplications" asp-route-filter="Approved"
       class="btn @(current == PartnerStatus.Approved
                             ? "btn-success"
                             : "btn-outline-success")">
        Approved
    </a>
    <a asp-action="PartnerApplications" asp-route-filter="Rejected"
       class="btn @(current == PartnerStatus.Rejected
                             ? "btn-danger"
                             : "btn-outline-danger")">
        Rejected
    </a>
</div>

<div class="row g-3">
    @if (!Model.Any())
    {
        <div class="col-12">
            <div class="alert alert-info">
                No @current applications found.
            </div>
        </div>
    }
    else
    {
        @foreach (var p in Model)
        {
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body d-flex flex-column">
                        <div class="d-flex align-items-center mb-3">
                            <img src="@(p.User.ProfilePicturePath ?? "/images/default-avatar.png")"
                                 class="rounded-circle me-2"
                                 style="width:40px; height:40px; object-fit:cover;"
                                 alt="Avatar" />
                            <div>
                                <h5 class="card-title mb-0">@p.User.FullName</h5>
                                <small class="text-muted">@p.User.Email</small>
                            </div>
                        </div>
                        <p class="text-truncate mb-4">
                            <strong>Exp:</strong>
                            @@p.YearsOfExperience.GetDisplayName()
                            &nbsp;•&nbsp;
                            <strong>Specs:</strong>
                            @string.Join(", ",
                            p.Specializations.Select(s => s.Specialization))
                </p>
                <div class="mt-auto">
                    <a asp-action="ReviewPartner" asp-route-id="@p.Id"
                       class="btn btn-sm
                        @(current == PartnerStatus.Pending
                                                   ? "btn-primary"
                                                   : current == PartnerStatus.Approved
                                                     ? "btn-success"
                                                     : "btn-danger")
                        w-100">
                        Review Details
                    </a>
                </div>
            </div>
        </div>
    </div>
        }
    }
</div>
