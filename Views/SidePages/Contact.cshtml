@{
    Layout = "_Layout";
    ViewData["Title"] = "Liên Hệ";
    ViewData["Description"] = "Liên hệ với Nihongo Sekai. Liên hệ đội ngũ hỗ trợ, ghé thăm văn phòng hoặc kết nối qua nhiều kênh khác nhau.";
}

@section Head {
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
          content="Liên hệ với Nihongo Sekai. Liên hệ đội ngũ hỗ trợ, ghé thăm văn phòng hoặc kết nối qua nhiều kênh khác nhau." />
}

@section Styles {
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="~/css/contact.css" />
    <link rel="stylesheet" href="~/css/styles.css" />
    <link rel="stylesheet" href="~/css/footer.css" />

    <style>
        /* === Toàn trang === */
        .page-header, .contact-form-section, .contact-faq-section {
            background-color: #fff1f1; /* hồng nhạt */
            padding: 2rem 0;
            font-family: "Source Sans Pro", sans-serif;
        }

        .contact-form-card {
            max-width: 700px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

            .contact-form-card::before {
                content: "";
                position: absolute;
                top: -20%;
                right: -20%;
                width: 200px;
                height: 200px;
                background: url('/images/sakura-petal.svg') no-repeat center;
                opacity: 0.05;
                transform: rotate(25deg);
            }

        /* === Form elements === */
        .contact-form .form-group {
            margin-bottom: 1.2rem;
            transition: transform 0.2s;
        }

            .contact-form .form-group:hover {
                transform: translateY(-2px);
            }

        .contact-form label {
            font-weight: 600;
            margin-bottom: .4rem;
            display: block;
        }

        .contact-form input.form-input,
        .contact-form select.form-select,
        .contact-form textarea.form-textarea {
            width: 100%;
            padding: .75rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: border-color 0.2s, box-shadow 0.2s;
            font-size: 1rem;
        }

        .contact-form input:focus,
        .contact-form select:focus,
        .contact-form textarea:focus {
            border-color: #f5365c;
            box-shadow: 0 0 8px rgba(245,54,92,0.2);
            outline: none;
        }

        .contact-form .btn-primary {
            background-color: #f5365c;
            border: none;
            padding: .8rem 2rem;
            font-size: 1rem;
            border-radius: 6px;
            color: #fff;
            transition: background 0.2s, transform 0.2s;
        }

            .contact-form .btn-primary:hover {
                background-color: #d52d50;
                transform: translateY(-2px);
            }

        .contact-form .btn-outline {
            background: transparent;
            border: 2px solid #f5365c;
            color: #f5365c;
            padding: .7rem 1.5rem;
            border-radius: 6px;
            transition: background 0.2s, color 0.2s;
        }

            .contact-form .btn-outline:hover {
                background: #f5365c;
                color: #fff;
            }

        #orderNumberGroup {
            display: none;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: .5rem;
            user-select: none;
        }

            .checkbox-label input {
                width: 1.1rem;
                height: 1.1rem;
                accent-color: #f5365c;
            }
    </style>
}

<main>
    <!-- Tiêu đề trang -->
    <section class="page-header">
        <div class="container">
            <h1 class="page-title">Liên Hệ</h1>
            <p class="page-subtitle">
                Chúng tôi sẵn sàng hỗ trợ bạn trong hành trình học tiếng Nhật. Liên hệ với chúng tôi bất cứ lúc nào!
            </p>
        </div>
    </section>

    <!-- Các tùy chọn liên hệ -->
    <section class="contact-options-section">
        <div class="container">
            <div class="contact-grid">
                <!-- Chat trực tiếp -->
                <div class="contact-card">
                    <div class="contact-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                        </svg>
                    </div>
                    <h3 class="contact-title">Chat Trực Tiếp</h3>
                    <p class="contact-description">
                        Trò chuyện với đội ngũ hỗ trợ của chúng tôi theo thời gian thực. Sẵn sàng 24/7 cho các vấn đề khẩn cấp.
                    </p>
                    <button class="btn btn-primary" onclick="openLiveChat()">Bắt Đầu Chat</button>
                </div>

                <!-- Hỗ trợ qua email -->
                <div class="contact-card">
                    <div class="contact-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                            <polyline points="22,6 12,13 2,6" />
                        </svg>
                    </div>
                    <h3 class="contact-title">Hỗ Trợ Qua Email</h3>
                    <p class="contact-description">
                        Gửi tin nhắn chi tiết và chúng tôi sẽ hồi đáp trong vòng 24 giờ.
                    </p>
                    <a href="mailto:support@nihongosekai.com" class="btn btn-outline">Gửi Email</a>
                </div>

                <!-- Hỗ trợ qua điện thoại -->
                <div class="contact-card">
                    <div class="contact-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
                        </svg>
                    </div>
                    <h3 class="contact-title">Hỗ Trợ Qua Điện Thoại</h3>
                    <p class="contact-description">
                        Gọi cho đội ngũ của chúng tôi để được hỗ trợ ngay lập tức về các sự cố kỹ thuật.
                    </p>
                    <a href="tel:+15554644664" class="btn btn-outline">+1 (555) NIHONGO</a>
                </div>

                <!-- Ghé thăm văn phòng -->
                <div class="contact-card">
                    <div class="contact-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                            <circle cx="12" cy="10" r="3" />
                        </svg>
                    </div>
                    <h3 class="contact-title">Ghé Thăm Văn Phòng</h3>
                    <p class="contact-description">
                        Đặt lịch ghé thăm trụ sở tại Tokyo hoặc văn phòng tại Đà Nẵng.
                    </p>
                    <button class="btn btn-outline" onclick="showOfficeLocations()">Xem Địa Điểm</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Form liên hệ -->
    <section class="contact-form-section">
        <div class="container">
            <div class="form-content">
                <div class="form-header">
                    <h2 class="section-title">Gửi Tin Nhắn Cho Chúng Tôi</h2>
                    <p class="section-subtitle">
                        Điền vào biểu mẫu bên dưới và chúng tôi sẽ liên hệ lại với bạn sớm nhất.
                    </p>
                </div>

                <form id="contactForm" class="contact-form">
                    <!-- Họ & Tên -->
                    <div class="form-group">
                        <label for="fullName">Họ &amp; Tên *</label>
                        <input type="text"
                               id="fullName"
                               name="fullName"
                               class="form-input"
                               placeholder="Nhập họ và tên đầy đủ"
                               required />
                    </div>

                    <!-- Email -->
                    <div class="form-group">
                        <label for="email">Địa Chỉ Email *</label>
                        <input type="email"
                               id="email"
                               name="email"
                               class="form-input"
                               placeholder="name@example.com"
                               required />
                    </div>

                    <!-- Chủ Đề -->
                    <div class="form-group">
                        <label for="subject">Chủ Đề *</label>
                        <select id="subject"
                                name="subject"
                                class="form-select"
                                required>
                            <option value="">Vui lòng chọn chủ đề</option>
                            <option value="technical">Hỗ Trợ Kỹ Thuật</option>
                            <option value="billing">Thanh Toán &amp; Hóa Đơn</option>
                            <option value="courses">Câu Hỏi Về Khóa Học</option>
                            <option value="partnerships">Đối Tác Doanh Nghiệp</option>
                            <option value="feedback">Phản Hồi &amp; Góp Ý</option>
                            <option value="other">Khác</option>
                        </select>
                    </div>

                    <!-- Mã Đơn Hàng (chỉ hiện khi billing) -->
                    <div class="form-group" id="orderNumberGroup">
                        <label for="orderNumber">Mã Đơn Hàng *</label>
                        <input type="text"
                               id="orderNumber"
                               name="orderNumber"
                               class="form-input"
                               placeholder="Nhập mã đơn hàng" />
                    </div>

                    <!-- Nội Dung -->
                    <div class="form-group">
                        <label for="message">Nội Dung Tin Nhắn *</label>
                        <textarea id="message"
                                  name="message"
                                  rows="5"
                                  class="form-textarea"
                                  placeholder="Mô tả chi tiết vấn đề của bạn..."
                                  required></textarea>
                    </div>

                    <!-- Nhận bản tin -->
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox"
                                   id="newsletter"
                                   name="newsletter" />
                            Tôi muốn nhận cập nhật về khóa học và tính năng mới
                        </label>
                    </div>

                    <!-- Gửi -->
                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-primary btn-large">
                            Gửi Tin Nhắn
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Địa điểm văn phòng -->
    <section class="office-locations-section" id="officeLocations">
        <div class="container">
            <h2 class="section-title">Các Văn Phòng Của Chúng Tôi</h2>
            <div class="offices-grid">
                <div class="office-card">
                    <div class="office-image">
                        <img src="https://daihoc.fpt.edu.vn/da-nang/wp-content/uploads/2025/01/toa_nha_alpha.webp"
                             alt="Văn phòng FPT Đà Nẵng" />
                    </div>
                    <div class="office-info">
                        <h3 class="office-title">Văn Phòng Đà Nẵng</h3>
                        <p>ĐẠI HỌC FPT, Thành phố Đà Nẵng</p>
                        <p>Ký túc xá A, Tầng 2</p>
                        <p>Việt Nam</p>
                        <h4>Giờ Làm Việc</h4>
                        <p>Thứ Hai–Thứ Sáu: 9:00–18:00 JST<br />Thứ Bảy: 10:00–16:00 JST</p>
                        <p>Điện thoại: +84 337‑580‑325<br />Email: fpt@nihongosekai.com</p>
                    </div>
                </div>
                <div class="office-card">
                    <div class="office-image">
                        <img src="https://tourism.danang.vn/wp-content/uploads/2023/02/cau-rong-da-nang-1350x900.jpeg"
                             alt="Văn phòng Liên Chiểu" />
                    </div>
                    <div class="office-info">
                        <h3 class="office-title">Văn Phòng Liên Chiểu</h3>
                        <p>123 Phố Market, Suite 2100</p>
                        <p>Đà Nẵng, Việt Nam</p>
                        <h4>Giờ Làm Việc</h4>
                        <p>Thứ Hai–Thứ Sáu: 9:00–17:00 PST<br />Cuối tuần: Theo lịch hẹn</p>
                        <p>Điện thoại: +84 123‑123‑123<br />Email: lienchieu@nihongosekai.com</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Liên hệ -->
    <section class="contact-faq-section">
        <div class="container">
            <h2 class="section-title">Câu Hỏi Thường Gặp</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <h3 class="faq-question">Bao lâu thì các bạn phản hồi yêu cầu?</h3>
                    <p class="faq-answer">
                        Chúng tôi thường phản hồi email trong vòng 24 giờ vào ngày làm việc.
                        Chat trực tiếp và hỗ trợ qua điện thoại có sẵn cho các vấn đề khẩn cấp.
                    </p>
                </div>
                <div class="faq-item">
                    <h3 class="faq-question">Tôi có thể đặt lịch bài học thử không?</h3>
                    <p class="faq-answer">
                        Có—liên hệ để đặt bài học thử miễn phí 30 phút với giáo viên chứng nhận trước khi đăng ký khóa học.
                    </p>
                </div>
                <div class="faq-item">
                    <h3 class="faq-question">Các bạn có đào tạo doanh nghiệp không?</h3>
                    <p class="faq-answer">
                        Chúng tôi cung cấp chương trình đào tạo tiếng Nhật tùy chỉnh cho doanh nghiệp.
                        Liên hệ đội ngũ đối tác để biết thêm chi tiết.
                    </p>
                </div>
                <div class="faq-item">
                    <h3 class="faq-question">Nhóm hỗ trợ hỗ trợ những ngôn ngữ nào?</h3>
                    <p class="faq-answer">
                        Nhóm hỗ trợ hoạt động bằng tiếng Anh, Nhật, Quan Thoại, Hàn và Tây Ban Nha.
                        Vui lòng cho chúng tôi biết ngôn ngữ bạn mong muốn khi liên hệ.
                    </p>
                </div>
            </div>
        </div>
    </section>
</main>

@section Scripts {
    <script src="~/js/script.js"></script>
    <script>
            document.addEventListener("DOMContentLoaded", () => {
            const subjectEl     = document.getElementById("subject");
            const orderGroup    = document.getElementById("orderNumberGroup");
            const orderInput    = orderGroup.querySelector("input");
            const form          = document.getElementById("contactForm");
            const submitButton  = form.querySelector("button[type=submit]");

            // Khi chọn chủ đề → show mã đơn nếu billing
            subjectEl.addEventListener("change", () => {
                const isBilling = subjectEl.value === "billing";
                orderGroup.style.display = isBilling ? "block" : "none";
                orderInput.required      = isBilling;
                if (!isBilling) orderInput.value = "";
            });

            // Validation helper
            function validateField(el) {
                if (!el.checkValidity()) {
                    el.classList.add("is-invalid");
                    return false;
                }
                el.classList.remove("is-invalid");
                return true;
            }

            // Lắng nghe blur để validate real‑time
            form.querySelectorAll("input, select, textarea").forEach(el => {
                el.addEventListener("blur", () => validateField(el));
            });

            // Xử lý submit
            form.addEventListener("submit", async e => {
                e.preventDefault();

                // 1) Validate tất cả
                const fields = Array.from(
                    form.querySelectorAll("input, select, textarea")
                ).filter(el => el.willValidate);

                const allValid = fields
                    .map(validateField)
                    .every(v => v === true);

                if (!allValid) {
                    window.NihongoSekai.showToast(
                      "Vui lòng điền đầy đủ và hợp lệ các trường được đánh dấu.",
                      "error"
                    );
                    return;
                }

                // 2) Mock gửi
                submitButton.disabled = true;
                submitButton.textContent = "Đang gửi...";
                try {
                    await new Promise(r => setTimeout(r, 1500));
                    window.NihongoSekai.showToast(
                      "Tin nhắn đã được gửi! Chúng tôi sẽ phản hồi trong vòng 24 giờ.",
                      "success"
                    );
                    form.reset();
                    // Ẩn lại mã đơn billing nếu cần
                    subjectEl.dispatchEvent(new Event("change"));
                } catch {
                    window.NihongoSekai.showToast(
                      "Gửi thất bại, vui lòng thử lại.",
                      "error"
                    );
                } finally {
                    submitButton.disabled = false;
                    submitButton.textContent = "Gửi Tin Nhắn";
                }
            });
        });

        async function handleContactFormSubmission(form) {
            try {
                window.NihongoSekai.showToast("Đang gửi...", "info");
                // Mô phỏng gọi API
                await new Promise(r => setTimeout(r, 1500));
                window.NihongoSekai.showToast(
                  "Tin nhắn đã được gửi! Chúng tôi sẽ phản hồi trong vòng 24 giờ.",
                  "success"
                );
                form.reset();
            } catch {
                window.NihongoSekai.showToast(
                  "Gửi tin nhắn thất bại. Vui lòng thử lại.",
                  "error"
                );
            }
        }

        function openLiveChat() {
            window.NihongoSekai.showToast(
              "Chat trực tiếp sắp ra mắt! Vui lòng sử dụng email hoặc điện thoại trước nhé.",
              "info"
            );
        }

        function showOfficeLocations() {
            document.getElementById("officeLocations")
                    .scrollIntoView({ behavior: "smooth" });
        }
    </script>
}
